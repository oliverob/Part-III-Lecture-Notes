\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{bm}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{braket}
\usepackage{qcircuit}
\usepackage{cancel}
\title{Quantum Computation}
\author{oliverobrien111 }
\date{July 2021}

\begin{document}

\maketitle
\section{Lecture 1}
\subsection{Review of Shor's algoirthm/quantum period finding algorithm}
\textbf{Polynomial time hierarchy}://
Computation with input of size $n$, and we are interested in the number of steps/gates (classical or quantum). When we say $O(poly(n))$ steps we regard this as an "efficent computation".\\\\
Shor's algorithm solves the factoring problem:\\
Given an integer $N$ needing $O(log N)$ bits, we want to find a non-trival factor in $O(poly n)$ time.\\\\
The best known classical algorithm (number sieve): $e^{O(n^{\frac{1}{3}} (\log n)^{\frac{1}{3}} )}$\\
Shor's alogrithm takes $O(n^3)$\\
\subsubsection{Quantum factoring algorithm (summary)}
\begin{enumerate}
        \item First, convert factoring into periodicity determination. Given $N$, choose $a< N$ s.t. $a$ is coprime (this is easy classically can be seen in part II lecture notes). Consider $f: \mathbb{Z} \rightarrow \mathbb{Z}_N$ $f(x) = a^x \mod N$. \textbf{Euler's Theorem}: if $f$ is periodic with period $r$, then it is called 'order of $a \mod N$'. 
        \item In order to find $r$ we need a quantum implementation of $f$. We are always workingon finite size registers so restricting $x \in \mathbb{Z}$ to $x \in \mathbb{Z}_M$ (for some large enough $M$): $f: \mathbb{Z}_M \rightarrow \mathbb{Z}_N$. $f$ will no longer be exactly preriodic but this would have neglible effect if $M$ is sufficently large e.g. $M=O(N^2)$
        \item Using the classical theory of continued fractions. Define Hilbert spaces $\mathcal{H}_M \rightarrow \{\ket{i}\}_{i \in \mathbb{Z}_M}, \mathcal{H}_N\rightarrow \{\ket{i}\}_{i \in \mathbb{Z}_N}$.
        \item $\ket{x} \rightarrow \ket{f(x)}$ is not generally a valid quantum operator, so we make it a unitary operation which can be implemented:
                $$
                U_f: \mathcal{H}_M \otimes \mathcal{H}_N \rightarrow \mathbb{H}_M \otimes \mathbb{H}_N
                $$
                $$
                U_f: \ket{i} \ket{k} \rightarrow \ket{i} \ket{k + f(i)}
                $$
        \item if $x \rightarrow f(x)$ can be classically computed in $O(poly(m))$ time ($m = \log M$)), then $U_f$ can be implemented in poly($m$) time quantumly too
        \item We will sometimes view $U_f$ as a black box/oracle and we will count the number of times the algorithm invokes the oracle.
        \item Back to facotoring to get $r$ we'll use the quantum algorithm for periodicity determination:
        \item Given an oracle $U_f$ with the promise that $f$ is periodic of some unknown period $r \in \mathbb{Z}_N$ so that $f(x+r) = f(x)$ and $f$ is one-to-one in this period (for all $0 \leq x_1 < x_2<r f(x_1) \neq f(x_2)$)
        \item To find $r$ in $O(poly n)$ with any persecribed success probability $1-\epsilon$ we use the following alogirthm:
                \begin{itemize}
                        \item Step 1: Create the state 
                                $$
                                \frac{1}{\sqrt{M}} \sum_{i=0}^{M-1} \ket{i} \ket{0}
                                $$
                        \item Step 2: Apply $U_f$ to get
                                $$
                                \frac{1}{\sqrt{M}} \sum_{i=0}^{M-1} \ket{i} \ket{f(i)}
                                $$
                        \item Step 3: Measure the 2nd register to get $y$. By the born rule the first register collapses to all those $i$: $f(i) =y$ i.e. $i = x_0, x_0 + r, x_o + 2r,..., x_0 + (A-1)r$, $0 \leq x_0 <r$.\\\\Discard the second register to get the following state:
                                $$
                                \ket{per} = \frac{1}{\sqrt{A}} \sum_{j=0}^{A-1} \ket{x_0 + jr}
                                $$
                         If we measure $\ket{per}$ in computation basis we will get a value of one of these states $x_0 + jr$ for uniformly random $j$. This only gives us a random element of $\mathbb{Z}_M$ with no information about $r$.
                        \item Step 4: Apply quantum fourier transform mod $M$ (QFT). Lets recap what QFT does:
                                $$
                                \ket{x} \rightarrow \frac{1}{\sqrt{M}} \sum_{y=0}^{M-1} \omega^{xy} \ket{y}, \forall x \in \mathbb{Z}_M, \omega = e^{2\pi i/ M}
                                $$
                                This can be implement in $O(m^2)$ time and gives state:
                                $$
                                QFT \ket{per} = \frac{1}{\sqrt{MA}} \sum_{j=0}^{A-1} \sum_{y=0}^{M-1}  \omega^{ (x_0 + jr)y} \ket{y} =  \frac{1}{\sqrt{MA}} \sum_{y=0}^{M-1} \omega^{x_0y}\left[  \sum_{j=0}^{A-1} \omega^{jry} \ket{y} \right]
                                $$
                        The square brackets will be:
                        $$
                        \begin{cases}
                                A & \text{if }y = KA= k\frac{M}{r}, x = 0, 1,..., r-1\\
                                0 & \text{otherwise}
                        \end{cases}
                        $$
                        So gives final state:
                        $$
                        QFT \ket{per} = \sqrt{\frac{A}{M}} \sum_{k=0}^{A-1} \omega^{x_0 k \frac{N}{r}} \ket{k \frac{M}{r}}
                        $$
                        Now the random shift $x_0$ only appears in the phase not in the ket labels. So now the measurement probabilities will be indepedant of $x_0$. When we measure this we get some value $c = \frac{k_0M}{r}$ with $k_0$ uniformly random in range $0 \leq k_0 < r$
                        $$
                        \frac{k_0}{r} = \frac{c}{M}
                        $$
                        As $c$ and $M$ are known, and $k_0$ is unknown but random in the given range. We want to find $r$ and so we recall several classical facts.\\\\
                        \textbf{Co-primality Theorem}: The number of integers less than $r$ that are coprime to $r$ grows with $O(\frac{r}{\log \log r})$\\\\
                        Therefore, the probability of $k_0$ being coprime to $r$ is $O(\frac{1}{\log \log r})$.\\\\
                        \textbf{Lemma}: If a single trial has success probability $p$ then if one repeats it $M^*$ times, for any $0<1-\epsilon<1$. We get probability of at least one success in $M^*$ trails is greater than $1-\epsilon$ if $M^* = \frac{- \log \epsilon}{p}$. i.e. roughly $O(1/p)$ trials suffice to achieve probability of success $> 1- \epsilon$
                \item After step 4 cancel $\frac{c}{M}$ down to an irredicible algorithm $\frac{a}{b}$ there is an efficent algorithm ($O(poly n)$) for this. This will give us $r$ as denominator $b$ if $k_0$ is coprime to $r$ with probablity $O(\frac{1}{\log \log r})$. So check $b$ value by computing $f(0)$ and $f(b)$ and $b = r \iff f(0) = f(b)$.\\\\
                        By repeating this process $M^* = O( \log \log r)$ times this will give us $r$ with any desired probability $1- \epsilon$. Since $r < M$ the whole algorithm takes $O(poly m)$ time!
                \end{itemize}
                
        \item From learning the period $r$ we can use number theory to find a factor of $N$
\end{enumerate}
\subsubsection{Further insights to QFT}
Now lets think about the implications of $QFT$. What does applying quantum fourier transform really achieve?\\\\
Lets consider a function: $f: \mathbb{Z}_M \rightarrow \mathbb{Z}_N$ with period $r \in \mathbb{Z}_M$, $A= \frac{M}{r}$. Define:
$$
R = \{ 0, r, 2r, 3r,..., (A-1)r\} < \mathbb{Z}_M
$$
$$
\ket{R} = \frac{1}{\sqrt{A}} \sum_{k=0}^{A-1} \ket{kr}
$$
$$
\ket{per} = \ket{x_0 + R} = \frac{1}{\sqrt{A}} \sum_{k=0}^{A-1} \ket{x_0 + rk}
$$
The problem was this random shift $x_0$ when measuring $\ket{per}$. For each $x_0 < \mathbb{Z}_M$ consider a mapping $k \rightarrow k+ x_0$. "Shift by $x_0$". It is a 1-1 invertible map, and can define a unitary version $U(x_0)$ on $\mathcal{H}_M$: $U(x_0) \ket{k} = \ket{k+x_0}$.
$$
\ket{x_0 + R} = U(x_0) \ket{R}
$$
Since $(\mathbb{Z}_M, +)$ is an abelian group $U(x_0)U(x_1) = U(x_0+x_1) = U(x_1)U(x_0)$. So all $U(x_i)$ commute as operators on $\mathcal{H}_M$. Therefore they have an orthonomal basis of common eigenvectors $\{ \ket{\chi_k}\}_{k \in \mathbb{Z}_M}$. These are called shift invariant states as $U(x_0) \ket{\chi_k} = \omega( x_0, k) \ket{\chi_k}$ for all $x_0, k \in \mathbb{Z}_M$ with the important caveat that $|\omega( x_0, k)| = 1$.\\\\
Consider $\ket{R}$ written in $\{ \ket{\chi_r}\}$ basis:
$$
\ket{R} = \sum_{k=0}^{M-1} a_k \ket{\chi_k}
$$
$a_k$ only depend on $r$ not on $x_0$. Then:
$$
\ket{per} = U(x_0) \ket{R} = \sum_{k=0}^{M-1} a_k \omega(x_0, k) \ket{\chi_k}
$$
Here it can be seen that the probability of measuring $k$ is 
$$
prob(k) = |a_k \omega(x_0, k)|^2= |a_k|^2
$$
So this is all indepedant of $x_0$ and depends only on $r$. So measuring in this basis gives us some information about $r$. So one can think of QFT as the unitary mapping that rotates $\chi$ basis into the standard computational basis. So can define QFT as:
$$
QFT \ket{\chi_k} = \ket{k}
$$
How do these mysterious shift invariant states look?
\subsubsection{Explicit form of shift invariant shapes}
$$
\ket{\chi_k} = \frac{1}{\sqrt{M}} \sum_{l=0}^{M-1} e^{-2\pi il \frac{k}{M}} \ket{l}
$$
$$
U(x_0) \ket{\chi_k} = \fraC{1}{\sqrt{M}} \sum_{l=0}^{M-1} e^{-2\pi i l \frac{k}{M}} \ket{l + x_0} =  \fraC{1}{\sqrt{M}} \sum_{\tilde l=0}^{M-1} e^{-2\pi i (\tilde l - x_0) \frac{k}{M}} \ket{\tilde l}  = e^{2\pi i k \frac{x_0}{M}} \ket{\chi_k}
$$
giving eigenvalue: $\omega(x_0, k) = e^{2\pi i k \frac{x_0}{M}}$. From this we could reconstruct the basis of QFT:
$$
[QFT]_{kl} = \frac{1}{\sqrt{M}} e^{2\pi i \frac{kl}{M}}
$$
\section{Lecture 3}
\subsection{Hidden Subgroup Problem}
Let $G$ be a finite group of size $|G|$. We are given an oracle $f: G \rightarrow X$ with $X$ just some set. We are promised there is a subgroup $K<G$ s.t.
\begin{itemise}
\item $f$ is constant on (left) cosets of $K$ in $G$
\item $f$ is distinct on distinct cosets
\end{itemise}\\\\
\textbf{Problem}: 'Determine' the 'hidden subgroup' $K$ (e.g. output a set of generators or sample uniformly from elements of $K$)\\\\
We want to solve in time $O(poly ( \log |G|))$ (efficent algorithm) with anuy consitent probability $1-\epsilon$.
\textbf{Examples of problems that can be cast as HSP}\\
Periodicity finding $f: \mathbb{Z}_M \rightarrow X$ periodic, period r 1-1 in period
$$
G = \mathbb{Z}_M, K = \{ 0,r,2r,..., (A-1)r\} < G
$$
Discrete Logarithm Problem: $p$ - prime number, $\mathbb{Z}^*_p$ group of integers with multiplication mod $p$, $g \in \mathbb{Z}_p^*$ to be a generator (or primitive root mod p). If $\mathbb{Z}^*_p = \{ g^0, g^1, ..., g^{r-2} \}$ and we have $g^{p-1} = 1$ (mod p). Fact: These always exist for $p$ is prime. Any $x \in \mathbb{Z}_p^*$ can be written as $x = g^y$ for some $y \in \mathbb{Z}_{p-1}$, $y = \log_g x$ is called the discrete log of $x$ to base $g$. Discrete log problem is given a generator $g$, $x \in \mathbb{Z}^*_p$ we want to compute $y = \log_g x$. To express this as the HSP:
$$
f: \mathbb{Z}_{p-1} \times \mathbb{Z}_{p-1} \rightarrow \mathbb{Z}_p^*
$$
$$
f(a,b) = g^a x^{-b} \mod p = g^{a-yb} \mod p
$$
Can check if $f(a_1, b_1) = f(a_2, b_2) \iff (a_1, b_1) = (a_2, b_2) + \lambda( y, 1), \lmbda \in \mathbb{Z}_{p-1}$:
$$
G = \mathbb{Z}_{p-1} \times \mathbb{Z}_{p-1}
$$
$$
K = \{ \lambda(y,1): \lambda \in \mathbb{Z}_{p-1} \} < G
$$
Then $f$ is constant and distinct on cosets of $K$ and generator $(y,1)$ of $K$ gives $y = \log_g x$\\\\
\textbf{Graph Problems}:\\
So we can solve problems like those above where $G$ is abelian, but we can also solve graph problems.\\\\
Consdier graph $A = (V,E)$, $|V| = n$ lets say that the graph is undirected and there is at most one edge between any two vertices. Vertices here are labelled by numbers from 1 to $n$.\\\\
Lets define an adjacency matrix $M_A$: $[M_a]_{ij} = \begin{cases} 1 & \iff (i,j)\\ 0 & \text{otherwise} \end{cases}$. The permuation group of $[n]$, $|P_n| = n!, \log |P_n| \sim O(n \log n)$. Define a group of automorphisms of group $A$ which is a set of permuations with the following property: $\pi \in P_n$ s.t. $\forall i,j (i,j)$ is an edge in $A$ $\iff (\pi(i), \pi(j))$ is also an edge in $A$.\\\\
An associated HSP (the case of non-abelian $G$):
$$
G = P_n, X = \text{set of all labelled graphs on }n\text{vertices}
$$
For any $A \in X$, define $f_A: G \rightarrow X$, $f_A(\pi) = $"A with vertex labels permuted by $\pi$"
$$
K = Aut(A)
$$
(Check $f(K)$ is constant and disctint on cosets of $Aut(A)$)\\\\
\textbf{Applications}:\\
If we can sample uniformly from $K$, then we can solve Graph Isomorphism problem (GI).This has a number of different applications in areas of computer science. Two labelled graphs $A$ and $B$ with $n$ vertices are isomorphic if there is a 1-1 map (i.e. permutation) $\pi[n] \rightarrow [n]$ s.t. $\forall i,j \in [n] (i,j)$ is an edge in $A$ $\iff$ $(\pi(i), \pi(j))$ is an edge in $B$. The GI problem is given to graphs $A$ and $B$ and deciding if they are isomorphic. This can be represented as a non-abealian HSP. There is no known poly(m) time classical algorithm to solve this problem, so $GI$ is clearly in $NP$ but not believed to be $NP$-complete (a class of problems such that every problem in NP can be reduced to an NP-complete problem these are the hardest NP problems).
In 2017, L Babai presented a quasi-polynomial algorithm for GI runtime $n^O(\log n)^2)$. This ranks in between polynomial runtime and exponential algorithms.
\section{Lecture 4}
\textbf{Quantum algorithm for finite abelian HSPs}
- Generalisation of period-finding algorithm\\
Write our abelian group $(G, +)$ additively\\
Construction of shift-invariant states and Fourier transform for $G$.\\
Representations of abelian $G$:\\
Consdier the mapping $\chi: G \rightarrow \mathbb{C}^* = \mathbb{C}- \{ 0\}$ with multiplication that satisfies:
$$
\chi( g_1 + g_2) = \chi(g_1) \chi(g_2), \forall g_1,g_2 \in G 
$$
$\chi$ is a group homomorphism from $G$ to $\mathbb{C}^*$. Such $\chi$'s are called irreducible representations of $G$. They have the following properties:
\textbf{Theorem 1}:\\
1) any value $\chi(g)$ is a $|G|$-th root of unity ($\chi \in \rightarrow S^1$ the unit circle)\\
2) Schur's lemma (orthogonality): If $\chi_i,\chi_j$ satisfy (HOM) then 
$$
\frac{1}{|G|} \sum_{g \in G} \chi_i (g) \bar {\chi_j} (g) = \delta_{ij}
$$
3) There are always exactly $|G|$ different functions $\chi$ satisfying (HOM).\\\\
\textbf{Examples}: $\chi(g) = 1, \forall g \in G$ is an irrep/ called a trival irrep\\
Label the trivial irrep as $\chi_0$, $0\in G$. Then for any other irrep $\chi \neq \chi_0$ orthonality to $\chi_0$ gives:
$$
\sum_{g \in G} \chi(g) = 0 \text{ if } \chi \neq \chi_0
$$
Going back to constructing shift-invariant states
\subsubsection{Shift-invariant states}
Consider a state space $\mathcal{H}_G, dim \mathcal{H}_G = |G|$ wtih basis $\{ \ket{g}\}_{g \in G}$. Now introduce shift operators $U(k)$ for $k \in G$ defined as follows:
$$
U(k): \ket{g} \rightarrow \ket{g+k}, g, k \in G
$$
All shift operators commute so there exists a simultaneous eigenbasis.\\
For each $\chi_k, k \in G$:
$$
\ket{\chi_k} = \frac{1}{\sqrt{|G|}} \sum_{g \in G} \bar{\chi_k} (g) \ket{g}
$$
By thereom 1 $\{ \chi_k \}$ form an orthonormal basis.
$$
U(g) \ket{\chi_k} = \chi_k(g) \ket{\chi_k}
$$
\textbf{Proof}:$$U(g) \ket{\chi_k} = \frac{1}{\sqrt{|G|}} \sum_{h \in G} \bar{\chi_k} (h) \ket{h + g}$$
        $$
        \{h' = h+ g\} = \frac{1}{\sqrt{|G|}} \sum_{h' \in G} \bar{\chi_k} (h' - g) \ket{h'}
        $$
        using HOM $\chi_k(-g) = \chi_k(g)^{-1} = \bar \chi_k(g) \implies \bar{\chi_k(h'-g)} = \bar \chi_k(h') \bar \chi_k(-g) = \bar \chi_k(h') \chi_k(g)$. Therefore,
        $$
        U(g) \ket{\chi_k} = \frac{1}{\sqrt{|G|}}\sum_{h' \in G} \chi_k(g) \bar \chi_k(h') \ket{h'} = \chi_k(g) \ket{\chi_k}
        $$
        So $\ket{\chi_k}$'s form a common eigenbasis\\\\
        Introduce Fourier transform QFT for a group $G$\\
- consider a unitary mapping on $\mathcal{H}_G$ mapping $\ket{\chi_k}$ basis to $\ket{g}$ basis
$$
QFT \ket{\chi_g} = \ket{g}, \forall g \in G
$$
$$
QFT^{-1} \ket{g} =  \ket{\chi_g}
$$
k-th column of $QFT^{-1}$ in $\ket{g}$ basis is mode of components of $\ket{\chi_k}$:
        $$
        [QFT^{-1}]_{gk} = \frac{1}{\sqrt{|G|}} \bar{\chi_k}(g)
        $$
        \textbf{Example}: $G = \mathbb{Z}_M$L\\
        Check $\chi_a(b) = e^{\frac{2\pi i a b}{M}}, a, b \in \mathbb{Z}_M$ satsifies HOM and has its irreps labelled by $a \in \mathbb{Z}_M$ with $\chi_0(b) = 1 \forall b \in \mathbb{Z}_m$.
        $$
        G = \mathbb{Z}_{M_1} \times ... \times \mathbb{Z}_{M_r}
        $$
        $$
        (a_1, ..., a_r ) = g_1, (b_1, ..., b_r) = g_2
        $$
        $$
        \chi_{g_1} (g_2) = e^{2\pi i ( \frac{a_1 b_1}{M_1} +... + \frac{a_r b_r}{M_r}}
        $$
This satifies HOM and our $QFT_G = QFT_{M_1} \otimes ... \otimes QFT_{M_r}$ on $\mathcal{H}_G = \mathcal{H}_{M_1} \otimes ... \otimes \mathcal{H}_{M_r}$.\\\\
This second example is exhaustive since we have a classification theroem:\\
\textbf{Classification theorem}: Any fintie abelian group $G$ is isomorphic to a direct product of the form $G = \mathbb{Z}_{M_1} \otimes ... \otimes \mathbb{Z}_{M_r}$. So $M_1$ can be taken in a form $p_1^{s_1},... p_r^{s_r}$.
\subsubsection{Quantum algorithm}
$$
f: G \rightarrow X
$$
with hidden subgroup $K$ and cosets $k = 0 + k, g_2 + k, ... g_m +k$, $m = \frac{|G|}{|K|}$. we will work on $\mathcal{H}_{|G|} \otimes \mathcal{H}_{|X|}, $\{\ket{g}\ket{x}\}_{g \in G, x \in X}$.\\
\begin{itemlist}
\item Create a state $\frac{1}{\sqrt{|G|}} \sum_{g \in G} \ket{g} \ket{0}\\
\item Apply $U_f$ and $\frac{1}{\sqrt{|G|}}\sum_{g \in G} \ket{g} \ket{f(g)}\\
        \item Measure the second register to get $f(g_0)$. The first register will not give the coset state:
                $$
                \ket{g_0 + k} = \frac{1}{\sqrt{|k|}} \sum_{k \in K} \ket{g_0 + k} = U(g_0) \ket{K}
                $$
        \item apply QFT and measure to get a result $g \in G$
\end{itemlist}
\section{Lecture 6}
We can write $\ket{K}$ in the shift-invariant basis $\{ \chi_g \}_{g \in G}$
$$
\ket{K} = \sum_g a_g \ket{\chi_g}
$$
$$
\ket{g_0+K} = U(g_0) \ket{K} = \sum_g a_g \chi_g(g_0) \ket{\chi_g}
$$
as $QFT \ket{\chi_g} = \ket{g}$ so after we apply QFT
$$
prob(g) = |a_g \chi_g(g_0)|^2 = |a_g|^2, |\chi_g(g_0) | = 1
$$
$$
QFT \ket{K} = \frac{1}{\sqrt{|G|}} \frac{1}{\sqrt{|K|}} \sum_{l \in G} ( \sum_{k \in K} \chi_l (k) \ket{l})$$
$\sum_{k \in K} \chi_l (k) \ket{l}$ involves irreps $\chi_l$ of $G$ restricted to subgroup $K < G$, and each such object is itself an irrep in $K$. Hence we have the following relation:
$$
\sum_{k \in K} \chi_l(k) = \begin{cases} |k| & if \chi_l \text{ restricts to the trival irrep of K}\\ 0 & \text{otherwise} \end{cases}
$$
$$
QFT \ket{K} = \sqrt{\frac{|K|}{|G|}} \sum_{l \in G} \ket{l}
$$
Then a measurement gives a uniformly random choice of $l$ s.t. $\chi_l(k) = 1$.\\
If $k$ has generators $k_1, ..., k_n$ where $M = O(\log(K)) = O(\log |G|)$. Then the output of a measurement gives us $\chi_l(k) = 1 \forall i$.\\\\
It can be shown that if $O(\log(|G|)$ values of $l$ chosen uniformly at random then with probability $>\frac{2}{3}$ they will suffice to determine a generating set for $k$ via the equations $\chi_l(k) = 1$.\\\\
\textbf{Example}: $G = \mathbb{Z}_{M_1} \times ... \times \mathbb{Z}_{M_l}$\\
$l = (l_1, ..., l_q) \in G$, $g = (b_1, ..., b_q) \in G$ gives $\chi_l(g) = e^{2\pi i( \frac{l_1 b_1}{M_1} + ... + \frac{l_q b_q}{M_q}$\\
        For $k = (k_1, ..., k_q) \in K$ with $\chi_l(k) =1 \implies \frac{l_1 k_1}{M_1} + ... + \frac{l_q k_q}{M_q} = 0 mod 1$. This is a homogenous linear equation on $k$ and $O(\log(k))$ such equations determine $k$ as null space.
        \subsubsection{Remarks on HSP for non-abelian groups $G$}
        Now we will consider multiplicative shifts. As before we can generate a bunch of coset states but it is curious to investigate what breaks down. 
        $$
        \ket{g_0 K} = \frac{1}{\sqrt{|K|}} \sum_{k \in K} \ket{g_0 k}, g_0 \in G\text{ is chosen randomly}
        $$
        The real problem with QFT construction is that there is no good basis of shift invariant states. This is because $U(g_0)$ don't commute. \\\\
        \textbf{Construction of non-abelian QFT}\\
        Consider a $d$-dimensional representation of $G$ and a group homomorphism $\chi: G \rightarrow U(d)$\\
        $\chi$ is irreducible if no subset of $\mathbb{C}^d$ is left invariant by all matrices $\chi(g), g \in G$. (i.e. we cannot simulatenoulsy block-diagonalize all of $\chi(g)$'s by a simple basis change)\\
        Let's define a complete set of irreps. It is a set $\chi_1,..., \chi_m$ s.t. that any irrep is unitarily equivalent to one of them. e.g. $\chi \sim \chi' = V \chi CV^{-1}, V \in U(d)$\\
        \textbf{Example}:  $G$ is abelian , all irreps have $d=1$, since all $\chi(g)$ commute. Theorem( non-abelian analogue of Theorem 1) (consullt Fulton and Hardes "Representation Theory" fo more information)\\
        If $d_1,...,d_m$ are the dimensions of a complete set of irreps $\chi_1, ..., \chi_M$ then:\\
        1) $d_1^2 +... + d_m^2 = |G|$\\
        2) $\chi_{i,jk} (g) $ is $(j,k)$ th matrix entry of $\chi_i(g)$ then by Schur orthogonality:
        $$
        \sum_g \chi_{i,jk}(g) \bar{\chi}_{i',j'k'}(g) = |G|\delta{ii'}\delta_{jj'}\delta{kk'}
        $$
Now if we look at the states that correspond to these irreps $\chi_{i,jk} = \sum_g\in G} \bar{\chi}_{i,jk} (g) \ket{g}$ they form an orthonormal basis.\\
QFT on $G$ is defined to be a unitary rotation between two basis of $\{ \chi_{i,jk} \}$ basis $\rightarrow \{ \ket{g} \}_{g \in G}$.\\
These takes $\ket{\chi_{i,jk}}$ are not shift-invariant for all $U(g_0)$ so this implies that measuring coset state $\ket{g_0 k}$ in the $\{ \ket{\chi}\}$ basis results in an output distribution that is not independant of $g_0$.\\
A "partial" shift-invariance survives. Consider a measuremnt $M_{rep}$ on $\ket{g_0 k}$ this measurement will only distinguish the irreps ($i$ values) and not all $(i,j,k)$'s. the outcome $i$ will be associated with $d_i^2$ dimensional orthogonal subspaces that are spanned by $\{\chi_{i,jk}\}_{j,k = 1}^{d_i}$.\\
Then $\chi_i(g_1 g_2) = \chi_i(g_1) \chi_i(g_2) \implies$ the output distribution of $i$ values is indeed independant of $g_0$.\\
So this gives us direct (but incomplete) information about $k$. For instance, conjugate subgroups $k$ and $L = g_0 K g_0', g_0 \in G$. This measurement will give us the same statistics.\\
$M_{rep}$ will result in the same output statistics\\
Not everything is lost there are some cases when this information is enough.\\\\
The reason HSP is good in the abelian case is we have an efficent $QFT$ transform. In other words QFT can be implemented in $poly(\log(|G|)$ times. This is true for abelian groups and some non-abelian groups (e.g. $P_n$).\\
\texbtf{Some partial results}:\\
For normal subgroups $gk = kg \for g \in G$ we have a theorem proven by Hall green, russel Ta shma in 2003 SIAM J Comp 32, p 916-934:\\
Suppose $G$ has QFT that is efficently implementable. Then if a hideen subgroup $k$ is a normal subgroup, then there is an efficent quantum HSP\\\\
Theorem( Edinsguin, Hoyer, Knill, 2004)\\
For general non-abelian HSP, $M = O(poly \log(|G|))$ then random coset states $\ket{g_1k}$,..., $\ket{g_nk}$ suffice to determine $k$ . But it is not known how to efficently determine $k$ from the $M$ coset states.
\section{Lecture 6}
\subsection{Phase estimation Algorithm}
- Unifying principle for quantum algorithms based on QFT\\
- also gives an alternative way of factoring (orginally discovered  by Kitaev)\\
The fact the phase estimation algorithm became so wide spread and you can cast every algorithm that is tangenetially ralted to QFt in QPE\\
Givem a unitary operator $U$. and eigenstates $\ket{v_{\phi}} = U\ket{v_{\phi}} = e^{2\pi i \phi} \ket{v_{\phi}}$\\
Want to estiamte the phase $\phi$ $0< \phi< 1$  ( up to $n$ bits of precision $\phi = 0. i_1 i_2,...i_n = i_1/2 + i_2/4 + ...$ for any given $n$)\\
We will have to implement controlled unitary opearotrs and in particular we will need Controlled-$U^k$ for integers $k$
$$
C-U^k \ket{0} \ket{\xi} = \ket{0}\ket{\xi}, C-U^k \ket{1}\ket{\xi} = \ket{1} U^k \ket{\xi}
$$
$\ket{\xi}$ has a general dimension $d$:
$$
U^k \ket{v_{\phi}} e^{2\pi i k \phi} \ket{v \phi}, C-U^k = (C-U)^k
$$
If we are given $U$ as a circuit description, we can easily implement $C-U$ by controlling each gate in $U$'s circuit. However, if $U$ is given as black box (e.g. a physical operation in the lab) we need further information as there is an inherent ambiguity as we have to account for local phase $e^{i\theta U}$ as it has no effect normally unless you use a controlled operation. \\\\
        If the unitary is specified in this ambiguous way we need to figure out what to do. It suffices to have an eigenstate $\ket{l}$ with a known eigenvalue $U\ket{l} = e^{i \alpha} \ket{l}$ then $e^{i \theta} U$ will map $\alpha \rightarrow \alpha + \theta$. Consider the following circuit:
       
\centerline{ \Qcircuit @C=1em @R=.7em {
\lstick{\ket{a}} & \qw & \ctrl{1} & \qw & \ctrl{1} & \gate{X} & \gate{P(-l)} & \gate{X}\\
\lstick{\ket{\xi}} & \qw & \qswap & \qw & \qswap & \qw & \qw & \qw \\
\lstick{\ket{\alpha}} & \qw & \qswap \qwx & \gate{U} & \qswap \qwx & \qw & \qw & \qw
               }}
               with $P(-l) = \begin{pmatrix}1 & 0 \\ 0 & e^{-il} \end{pmatrix}$. This correctly gives $C-U$. We'll want a "generalised controlled-U" that gives:
               $$
               \ket{x} \ket{\xi} \rightarrow \ket{x} U^x \ket{\xi} x \in \mathbb{Z}_{2^n}
               $$
               For $x= x_{n-1}...x_1x_0 = 2^0 x_0 + 2^1 x_1 + 2^2 x_2 ... + 2^{n-1} x_{n-1}$:\\
              \centerline{ 
             \Qcircuit @C=1em @R=.7em { 
               \lstick{\ket{x_{n-1}}} & \qw & \qw & \cdots & \ctrl{4} \\
                & \cdots & \cdots & \cdots & \cdots \\
               \lstick{\ket{x_{1}}} & \qw & \ctrl{2} & \cdots & \qw \\
               \lstick{\ket{x_{0}}} & \ctrl{1} & \qw & \cdots & \qw \\
       \lstick{\ket{\xi}} & \gate{U^{2^0}} & \gate{U^{2^1}} & \cdots & \gate{U^{2^{n-1}}} 
               }}
       
               If we input $\ket{\xi} = \ket{ V_{\phi}}$ then we get $e^{2\pi i \phi x} \ket{x} \ket{v_{\phi}}$. Now superpose over all $x = 0,1,2,..., 2^{n-1}$ by applying hadamards to all the qubits before applying the circuit, take $\ket{\xi} = \ket{v_{\phi}}$:
\\\\
This gives output $\ket{A} = \frac{1}{\sqrt{2^n}} \sum_x e^{2\pi i \phi x} \ket{x}$. Applying $QFT^{-1}$ to $\ket{A}$ and measure. We get $y_0 y_1 ... y_{n-1}$. Then output the number $0.y_1y_2...y_{n-1} = \frac{y_0}{2} + \frac{y_1}{4} + ... + \frac{y_{n-1}}{2^{n}}$ as an estimate of $\phi$.\\\\ Now lets assume an idealised situtation where $\phi$ has only $n$ binary digits:
$$
\phi = 0.z_1...z_{n-1}
$$
Then $\phi = \frac{z}{2^n}$ where $z$ is an n-bit integer in $\mathbb{Z}_{2^n}$:
$$
\ket{A} = \frac{1}{\sqrt{2^n}} \sum_2 e^{2\pi i 2^n z/2^n} \ket{x} 
$$
is a QFT of $\ket{z}$. Applying $QFT^{-1} \ket{A} = \ket{z}$ and we get $\phi$ exactly with certainity.\\\\
Note the algorithm up to the final measurements is a unitary operation mapping:
$$
\ket{0} \ket{0} ... \ket{0} \ket{ v_{\phi}} \rightarrow \ket{z_0} \ket{z_1} ... \ket{z_{n-1}} \ket{v_{\phi}}
$$
If $\phi$ has more than $n$ bits $\phi = 0.z_0 z_1... z_{n-1}| z_{n} z_{n+1}$.\\
\textbf{Theorem (PE)}: If measurements in the algorithm give $y_0y_1...y_n$ and the aoutput $\Theta = 0. y_0y_1...y_{n-1}$ then :\\
a) Prob ( $\Theta$ is closeset $n$-binary digit approx to $\phi$) $\geq \frac{4}{\pi^2} = 0.4$\\
b) Prob( $|\Theta - \phi| \geq \epsilon$) $\leq O(\frac{1}{2^n \epsilon}$\\\\
We will show that  Prob( $|\Theta - \phi| \geq \epsilon$) $\leq \frac{1}{2^{n+1} \epsilon})$
\section{Lecture 8}
Today we will prove the Phase estimation theorem. We need to change the defintion of distance as we need a distance on a circle.\\\\
Define $d(\theta, \phi) = \min \{ |\theta -\phi|, |1 + \phi - \theta|, |1+ \theta - \phi|\}$ which is the distance on the circle. Lets consider the normal binary expansion 0.999999 the closest string should be 1.\\\\
\textbf{Theorem (Phase Estimation)}: If the output of PE algorithm with $n$ lines (initited in as zeros) is $\theta = 0.y_0y_1...y_{m-1}$, then:\\
a) Prob ( $\theta$ is closeset $n$-binary digit approx to $\phi$, $d(\theta, \phi) \leq \frac{1}{2^{n+1}}$) $\geq \frac{4}{\pi^2} = 0.4$\\
b) Prob( $|\theta - \phi| \geq \epsilon$) $\leq O(\frac{1}{2^n \epsilon})$ for $\epsilon$ fixed\\\\
Recall: the output is obtained by measuring an $n$-qubit state $QFT^{-1} \ket{A}$ where $\ket{A} = \frac{1}{\sqrt{2^n}} \sum_{x = 0}^{2^n-1} e^{2\pi i l x} \ket{x}$
$$
QFT^{-1} \ket{x} = \frac{1}{\sqrt{2^n}} \sum_{y= 0}^{2^n-1} e^{-2\pi i \frac{y x}{2^n} \ket{y}}
$$
Soon we will change the notation to make sure it is not overloaded with these powers of $2^n$
$$
QFT^{-1} \ket{A} = \frac{1}{2^n}\sum_{y=0} \sum_{x=0} e^{2 \pi i ( \psi - \frac{y}{2^n})x} \ket{y}
$$
Let $\{ \phi = 2^n \psi \}$:
$$
QFT^{-1} \ket{A} = \frac{1}{2^n}\sum_{y=0} \sum_{x=0} e^{2 \pi i  \frac{\phi - y}{2^n})x} \ket{y} = \frac{1}{2^n}  \sum_y \frac{ 1 - e^{2\pi i (\phi - y)}}{ 1 - e^{2\pi i \frac{\phi - y}{2^n}}} \ket{y}
$$
In the case $\phi - y \neq 0$:
$$
Prob( see\> y) =  \frac{1}{2^n} |\sum_{x=0}^{2^n-1} e^{2\pi i\frac{(\phi - y)}{2^n} x}|^2 = \frac{1}{2^{2n}} \frac{ |1 - e^{2\pi i (\phi - y)}|^2}{ | 1 - e^{2\pi i \frac{\phi - y}{2^n}}|^2} = \frac{1}{2^{2n}} \frac{| 1 - e^{2\pi i (\psi - \frac{y}{2^n}} 2^n|^2}{| 1 - e^{2\pi i (\psi - \frac{y}{2^n}}|^2}
$$
As $\theta_y = \frac{y}{2^n}$ and observe that $|1- e^{2\pi i(\psi - \theta_y})|^2 = |1 - e^{2\pi i d(\psi, \theta_y)}|^2$ therefore:
        $$
Prob( see\> y) =  \frac{1}{2^{2n}} \frac{|1 - e^{2\pi i 2^n d(\psi, \theta_y)}|^2}{|1 - e^{2 \pi i d(\psi, \theta_y}|^2}
        $$
As $0<d(\psi, \theta_y)\leq \frac{1}{2}$ we will ise the following bounds:\\
               i) $|1-e^{i \alpha}| \leq 2|$\\
               ii) $|1-e^{i \alpha}| \leq |alpha|$\\
               iii) For $|alpha| \leq \phi$ $|1- e^{i \alpha}|= 2|sin( \frac{\alpha}{2})| \geq \frac{2|alpha|}{\pi}$\\\\
               The last of thse comes from the fact that for positive $\alpha$ we hae $\sin(\alpha/2) \geq \frac{\alpha/ \pi}$\\\\
               When $d(\psi, \theta) \leq \frac{1}{2^{n+1}}$ implies that $y$ is the best approxiamtion for $\psi$ and $2\pi d(\psi, \theta_y) 2^n \leq \frac{2^{n+1}}{2^{n+1}} \pi$ so:
               $$
               Prob( y is best approximation) \geq \frac{1}{2^{2n}} | \frac{2}{\pi} \frac{2 \pi d(\psi, \theta_y)}{2 \pi d(\psi, \theta)}|^2 = \frac{4}{\pi^2}
               $$
               The calculations for the above will be on the moodle\\\\
               \textbf{Further remarks}:\\\\
               If $C-U^{2^n}$ is implement as $(C-U)^{2^{\alpha}}$, then PE algorithm needs exponential time ($ 1+ 2+... + 2^{n-1} = 2^{n}-1$). But for some some $U$ implementing $C-U^{2^k}$ requries only polynomial time so we get a poly-time PE algorithm. Harks back to the algorithm for finding powers by repeated squaring, expressing the exponent in binary and then doing repeated squaring. The number of applications of controlled unitaries does not depend on $d$ the dimension of the space. This can be used to rpovide an alternative factoring algorithm ( due to A.Kitaev) ( see example sheet).\\\\
               In many applications we feed an arbitary state to the last register rather than an eigenstate. If instead of $\ket{v_{\phi}}$ we input general state $\ket{\xi}$, expand in eigenbasis of $U$:
               $$
               \ket{\xi} = \sum_j c_j \ket{v_{\phi_j}}, U \ket{v_{\phi_j}} = e^{2 \pi i \phi_j} \ket{v_{\phi_j}}
               $$
               Then we get (before the final measuremnt) a unitary process $U_{PE}$:
               $$
               \ket{00..00} \ket{\xi} \rightarrow^{U_{PE}} \sum_j c_j \ket{\psi_j} \ket{v_{\phi_j}}
               $$
               The Born rule implies that the final measurement will give a choice of $\phi_j$'s (or an approximation) it can be choosen with probability $|c_j|^2$. This is not some average of the $\phi_j$ values.\\\\
               Will be elaborated more in the notes on moodle on the following:\\\\
               If you want to have $n$-qubits and want to get $m$-bits correctly probablility of success $1- \eta$, then must have :
               $$
               n \geq m + \log \frac{1}{\eta}
               $$
               \subsection{Amplitude amplification}
Much like when we multiple up to HSP we revisited shors alogrithm, in this case we revisit grovers algorithm. This is an apotheosis of technique in Grover's algorithm.
\subsubsection{Background}
\textbf{Reflection Operators}:

\end{document}
